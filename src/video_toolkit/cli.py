import argparseimport osimport sysfrom video_toolkit.downloader import download_best_quality_mp4from video_toolkit.trimmer import trim_videofrom video_toolkit.utils.path_utils import get_downloads_dirclass MyArgumentParser(argparse.ArgumentParser):    """Custom ArgumentParser: prints help on error instead of default message."""    def error(self, message):        self.print_help()        print(f"\nError: {message}\n")        sys.exit(1)# ---------- HANDLER FUNCTIONS ----------def handle_download(args):    """Download video from URL."""    download_best_quality_mp4(args.url)def handle_trim(args):    """Trim a local video file."""    trim_video(        input_video_path=args.path,        start_time=args.start,        end_time=args.end,    )def handle_download_trim(args):    """Download a video and trim the latest downloaded file."""    output_dir = get_downloads_dir()    success = download_best_quality_mp4(args.url, output_path=output_dir)    if not success:        return    # Pick the most recently downloaded video    downloaded_files = sorted(        [os.path.join(output_dir, f) for f in os.listdir(output_dir)],        key=os.path.getmtime,        reverse=True    )    latest_video = downloaded_files[0]    print(f"\nüìÅ Latest downloaded video: {latest_video}")    trim_video(        input_video_path=latest_video,        start_time=args.start,        end_time=args.end,    )# ---------- MAIN CLI ----------def main():    parser = MyArgumentParser(        prog="video-toolkit",        description="Download and trim videos easily"    )    subparsers = parser.add_subparsers(dest="command")    # --- DOWNLOAD ---    download_parser = subparsers.add_parser(        "download",        help="Download a YT video",        usage="video-toolkit download '<url>'",        description="Download a YT video.\nExample:\n  video-toolkit download 'https://youtu.be/VIDEO_ID'"    )    download_parser.add_argument("url", help="YT video URL")    download_parser.set_defaults(func=handle_download)    # --- TRIM ---    trim_parser = subparsers.add_parser(        "trim",        help="Trim a local video",        usage="video-toolkit trim --path <video_path> --start <start_time> --end <end_time>",        description="Trim a local video file.\nExample:\n  video-toolkit trim --path video.mp4 --start 00:01:00 --end 00:02:00"    )    trim_parser.add_argument("--path", required=True, help="Path to video file")    trim_parser.add_argument("--start", required=True, help="Start time HH:MM:SS(.mmm)")    trim_parser.add_argument("--end", required=True, help="End time HH:MM:SS(.mmm)")    trim_parser.set_defaults(func=handle_trim)    # --- DOWNLOAD + TRIM ---    dt_parser = subparsers.add_parser(        "download-trim",        help="Download a video and trim it",        usage="video-toolkit download-trim '<url>' --start <start_time> --end <end_time>",        description="Download a video and trim in one step.\nExample:\n  video-toolkit download-trim 'https://youtu.be/VIDEO_ID' --start 00:01:00 --end 00:02:00"    )    dt_parser.add_argument("url", help="YT video URL")    dt_parser.add_argument("--start", required=True, help="Start time HH:MM:SS(.mmm)")    dt_parser.add_argument("--end", required=True, help="End time HH:MM:SS(.mmm)")    dt_parser.set_defaults(func=handle_download_trim)    # Show help if no command    if len(sys.argv) == 1:        parser.print_help()        sys.exit(0)    args = parser.parse_args()    args.func(args)if __name__ == "__main__":    main()